!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var o,l,c,d,u,p,e,t,r,i,m,y,f,g,n,s,h,v,w,a,b,S,A,O,I;o=Object.create,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,t=(e,t,r)=>{r=null!=e?o(u(e)):{};var i=!t&&e&&e.__esModule?r:l(r,"default",{value:e,enumerable:!0}),a=e,n=void 0,s=void 0;if(a&&"object"==typeof a||"function"==typeof a)for(let e of d(a))p.call(i,e)||e===n||l(i,e,{get:()=>a[e],enumerable:!(s=c(a,e))||s.enumerable});return i},r=(e=(e,t)=>function(){return t||(0,e[d(e)[0]])((t={exports:{}}).exports,t),t.exports})({"external-global-plugin:react"(e,t){t.exports=Spicetify.React}}),i=e({"external-global-plugin:react-dom"(e,t){t.exports=Spicetify.ReactDOM}}),m=e({"node_modules/json-2-csv/lib/constants.js"(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.excelBOM=e.defaultCsv2JsonOptions=e.defaultJson2CsvOptions=e.errors=void 0,e.errors={optionsRequired:"Options were not passed and are required.",json2csv:{cannotCallOn:"Cannot call json2csv on",dataCheckFailure:"Data provided was not an array of documents.",notSameSchema:"Not all documents have the same schema."},csv2json:{cannotCallOn:"Cannot call csv2json on",dataCheckFailure:"CSV is not a string."}},e.defaultJson2CsvOptions={arrayIndexesAsKeys:!1,checkSchemaDifferences:!1,delimiter:{field:",",wrap:'"',eol:"\n"},emptyFieldValue:void 0,escapeHeaderNestedDots:!0,excelBOM:!1,excludeKeys:[],expandNestedObjects:!0,expandArrayObjects:!1,prependHeader:!0,preventCsvInjection:!1,sortHeader:!1,trimFieldValues:!1,trimHeaderFields:!1,unwindArrays:!1,useDateIso8601Format:!1,useLocaleFormat:!1,wrapBooleans:!1},e.defaultCsv2JsonOptions={delimiter:{field:",",wrap:'"',eol:"\n"},excelBOM:!1,preventCsvInjection:!1,trimFieldValues:!1,trimHeaderFields:!1},e.excelBOM="\ufeff"}}),y=e({"node_modules/doc-path/lib/path.js"(e){"use strict";function u(e){var t=function(t){for(let e=0;e<t.length;e++){var r=0<e?t[e-1]:"";if("."===t[e]&&"\\"!==r)return e}return-1}(e);return{dotIndex:t,key:e.slice(0,0<=t?t:void 0).replace(/\\./g,"."),remaining:e.slice(t+1)}}Object.defineProperty(e,"__esModule",{value:!0}),e.setPath=e.evaluatePath=void 0,e.evaluatePath=function t(e,r){if(!e)return null;const{dotIndex:i,key:a,remaining:n}=u(r);var s,o="object"==typeof e&&r in e?e[r]:void 0,l="object"==typeof e&&a in e?e[a]:void 0;return 0<=i&&"object"==typeof e&&!(r in e)?(s=u(n).key,s=parseInt(s),Array.isArray(l)&&isNaN(s)?l.map(e=>t(e,n)):t(l,n)):Array.isArray(e)?(s=parseInt(a),r!==a||-1!==i||isNaN(s)?e.map(e=>t(e,r)):l):0<=i&&r!==a&&"object"==typeof e&&a in e?t(l,n):-1===i&&"object"==typeof e&&a in e&&!(r in e)?l:o},e.setPath=function(e,t,r){if(!e)throw new Error("No object was provided.");if(t)return function t(e,r,i){const{dotIndex:a,key:n,remaining:s}=u(r);if(r.startsWith("__proto__")||r.startsWith("constructor")||r.startsWith("prototype"))return e;if(0<=a){const o=parseInt(n);if(!("object"!=typeof e||null===e||n in e||!Array.isArray(e)||isNaN(o)))return e[n]=e[n]??{},t(e[n],s,i),e;if(!("object"!=typeof e||null===e||n in e)&&Array.isArray(e))return e.forEach(e=>t(e,r,i)),e;if(!("object"!=typeof e||null===e||n in e||Array.isArray(e))){const l=u(s)["key"],c=parseInt(l);if(isNaN(c)){if(""===s)return e[r]=i,e;e[n]={}}else e[n]=[]}t(e[n],s,i)}else{if(Array.isArray(e)){const d=parseInt(n);return r!==n||-1!==a||isNaN(d)?e.forEach(e=>t(e,s,i)):e[n]=i,e}e[n]=i}return e}(e,t,r);throw new Error("No keyPath was provided.")}}}),f=e({"node_modules/deeks/lib/utils.js"(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isDocumentToRecurOn=e.flatten=e.unique=void 0,e.unique=function(e){return[...new Set(e)]},e.flatten=function(e){return[].concat(...e)},e.isDocumentToRecurOn=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&Object.keys(e).length}}}),g=e({"node_modules/deeks/lib/types.js"(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})}}),n=e({"node_modules/deeks/lib/deeks.js"(e){"use strict";var i=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,a)}:function(e,t,r,i){e[i=void 0===i?r:i]=t[r]}),a=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return a(t,e),t},r=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)},s=(Object.defineProperty(e,"__esModule",{value:!0}),e.deepKeysFromList=e.deepKeys=void 0,t(f()));function n(e,t){t=u(t);return"object"==typeof e&&null!==e?function r(i,a,n){const e=Object.keys(a).map(e=>{const t=d(i,c(e,n));return n.expandNestedObjects&&s.isDocumentToRecurOn(a[e])||n.arrayIndexesAsKeys&&Array.isArray(a[e])&&a[e].length?r(t,a[e],n):n.expandArrayObjects&&Array.isArray(a[e])?l(a[e],t,n):n.ignoreEmptyArrays&&Array.isArray(a[e])&&!a[e].length?[]:t});return s.flatten(e)}("",e,t):[]}function o(e,t){const r=u(t);return e.map(e=>"object"==typeof e&&null!==e?n(e,r):[])}function l(e,t,r){let i=o(e,r);return e.length?e.length&&0===s.flatten(i).length?[t]:(i=i.map(e=>Array.isArray(e)&&0===e.length?[t]:e.map(e=>d(t,c(e,r)))),s.unique(s.flatten(i))):r.ignoreEmptyArraysWhenExpanding?[]:[t]}function c(e,t){return t.escapeNestedDots?e.replace(/\./g,"\\."):e}function d(e,t){return e?e+"."+t:t}function u(e){return{arrayIndexesAsKeys:!1,expandNestedObjects:!0,expandArrayObjects:!1,ignoreEmptyArraysWhenExpanding:!1,escapeNestedDots:!1,ignoreEmptyArrays:!1,...e??{}}}r(g(),e),e.deepKeys=n,e.deepKeysFromList=o}}),s=e({"node_modules/json-2-csv/lib/utils.js"(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isInvalid=e.flatten=e.unique=e.arrayDifference=e.isError=e.isUndefined=e.isNull=e.isObject=e.isString=e.isNumber=e.unwind=e.getNCharacters=e.removeEmptyFields=e.isEmptyField=e.computeSchemaDifferences=e.isDateRepresentation=e.isStringRepresentation=e.deepCopy=e.validate=e.buildC2JOptions=e.buildJ2COptions=void 0;var o=y(),t=m(),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/;function l(e){return JSON.parse(JSON.stringify(e))}function i(e){return n(e)||a(e)||""===e}function a(e){return null===e}function n(e){return void 0===e}function s(e,t){return e.filter(e=>!t.includes(e))}e.buildJ2COptions=function(e){return{...t.defaultJson2CsvOptions,...e,delimiter:{field:e?.delimiter?.field??t.defaultJson2CsvOptions.delimiter.field,wrap:e?.delimiter?.wrap||t.defaultJson2CsvOptions.delimiter.wrap,eol:e?.delimiter?.eol||t.defaultJson2CsvOptions.delimiter.eol},fieldTitleMap:Object.create({})}},e.buildC2JOptions=function(e){return{...t.defaultCsv2JsonOptions,...e,delimiter:{field:e?.delimiter?.field??t.defaultCsv2JsonOptions.delimiter.field,wrap:e?.delimiter?.wrap||t.defaultCsv2JsonOptions.delimiter.wrap,eol:e?.delimiter?.eol||t.defaultCsv2JsonOptions.delimiter.eol}}},e.validate=function(e,t,r){if(!e)throw new Error(r.cannotCallOn+` ${e}.`);if(t(e))return!0;throw new Error(r.dataCheckFailure)},e.deepCopy=l,e.isStringRepresentation=function(e,t){var r=e[0],e=e[e.length-1];return r===t.delimiter.wrap&&e===t.delimiter.wrap},e.isDateRepresentation=function(e){return r.test(e)},e.computeSchemaDifferences=function(e,t){return s(e,t).concat(s(t,e))},e.isEmptyField=i,e.removeEmptyFields=function(e){return e.filter(e=>!i(e))},e.getNCharacters=function(e,t,r){return e.substring(t,t+r)},e.unwind=function(e,n){const s=[];return e.forEach(e=>{{var r=s,i=e,a=n;e=(0,o.evaluatePath)(i,a);let t=l(i);Array.isArray(e)&&e.length?e.forEach(e=>{t=l(i),r.push((0,o.setPath)(t,a,e))}):(Array.isArray(e)&&0===e.length&&(0,o.setPath)(t,a,""),r.push(t))}}),s},e.isNumber=function(e){return!isNaN(Number(e))},e.isString=function(e){return"string"==typeof e},e.isObject=function(e){return"object"==typeof e},e.isNull=a,e.isUndefined=n,e.isError=function(e){return"[object Error]"===Object.prototype.toString.call(e)},e.arrayDifference=s,e.unique=function(e){return[...new Set(e)]},e.flatten=function(r){if(r.flat)return r.flat();if(1e5<r.length){let t=[];for(let e=0;e<r.length;e+=1e5)t=t.concat(...r.slice(e,e+1e5));return t}return r.reduce((e,t)=>e.concat(t),[])},e.isInvalid=function(e){return e===1/0||e===-1/0}}}),h=e({"node_modules/json-2-csv/lib/json2csv.js"(e){"use strict";var i=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,a)}:function(e,t,r,i){e[i=void 0===i?r:i]=t[r]}),a=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return a(t,e),t},v=(Object.defineProperty(e,"__esModule",{value:!0}),e.Json2Csv=void 0,y()),w=n(),b=m(),S=t(s());e.Json2Csv=function(s){const r=new RegExp(s.delimiter.wrap,"g"),i=/\r?\n|\r/,a=s.parseValue&&"function"==typeof s.parseValue?s.parseValue:null,e=s.expandArrayObjects&&!s.unwindArrays,o={arrayIndexesAsKeys:s.arrayIndexesAsKeys,expandNestedObjects:s.expandNestedObjects,expandArrayObjects:e,ignoreEmptyArraysWhenExpanding:e,escapeNestedDots:!0};function l(e){if(0===e.length)return[];if(s.checkSchemaDifferences){var t=(r=e)[0],r=r.slice(1);if(r=function(r,e){return e.reduce((e,t)=>{return 0<S.computeSchemaDifferences(r,t).length?e+1:e},0)}(t,r))throw new Error(b.errors.json2csv.notSameSchema);return t}return S.unique(S.flatten(e))}function c(e){return s.excludeKeys?e.filter(e=>{for(const r of s.excludeKeys){var t=r instanceof RegExp?r:new RegExp("^"+r);if(r===e||e.match(t))return!1}return!0}):e}function d(e){return s.sortHeader&&"function"==typeof s.sortHeader?e.sort(s.sortHeader):s.sortHeader?e.sort():e}function u(){return s.keys?s.keys.map(e=>"object"==typeof e&&"field"in e?(s.fieldTitleMap[e.field]=e.title??e.field,e.field):e):[]}function n(e){const a=s.keys?s.keys.flatMap(e=>"string"!=typeof e&&e?.wildcardMatch?e.field:[]):[];var t=u(),e=(0,w.deepKeysFromList)(e,o);const n=l(e);if(s.keys){e=(s.keys=t).flatMap(e=>{if(!a.includes(e))return e;var t=[],r=new RegExp("^"+e);for(const i of n)e!==i&&!i.match(r)||t.push(i);return t});if(!s.unwindArrays)return d(c(e))}return d(c(n))}function p(t,e=!1){return s.unwindArrays?(t.headerFields.forEach(e=>{t.records=S.unwind(t.records,e)}),t.headerFields=n(t.records),function(e){for(const r of e.records)for(const i of e.headerFields){var t=(0,v.evaluatePath)(r,i);if(Array.isArray(t))return 1}}(t)?p(t,e):e?(s.keys&&(e=u(),t.headerFields=c(e)),t):p(t,!0)):t}function f(t){return t.recordString=t.records.map(e=>{return function(r,e){const i=[];return e.forEach(e=>{let t=(0,v.evaluatePath)(r,e);!S.isUndefined(s.emptyFieldValue)&&S.isEmptyField(t)?t=s.emptyFieldValue:s.expandArrayObjects&&Array.isArray(t)&&(t=function(e){var t=S.removeEmptyFields(e);{if(!e.length||!t.length)return s.emptyFieldValue||"";if(1===t.length)return t[0]}return e}(t)),i.push(t)}),i}(e,t.headerFields).map(e=>{return e=g(e=y(e)),h(a?a(e,m):m(e))}).join(s.delimiter.field)}).join(s.delimiter.eol),t}function m(e){var t=e instanceof Date;return null===e||Array.isArray(e)||"object"==typeof e&&!t?JSON.stringify(e):void 0===e?"undefined":t&&s.useDateIso8601Format?e.toISOString():s.useLocaleFormat?e.toLocaleString():e.toString()}function y(e){return s.trimFieldValues?Array.isArray(e)?e.map(y):"string"==typeof e?e.trim():e:e}function g(e){return s.preventCsvInjection?Array.isArray(e)?e.map(g):"string"!=typeof e||S.isNumber(e)?e:e.replace(/^[=+\-@\t\r]+/g,""):e}function h(e){var t=s.delimiter.wrap;return e=(e=e.includes(s.delimiter.wrap)?e.replace(r,t+t):e).includes(s.delimiter.field)||e.includes(s.delimiter.wrap)||e.match(i)||s.wrapBooleans&&("true"===e||"false"===e)?t+e+t:e}return{convert:function(e){e=e=f(p({headerFields:n(e=Array.isArray(e)?e:[e]),records:e,header:"",recordString:""})),s.prependHeader&&(e.headerFields=e.headerFields.map(h)),e=e,s.trimHeaderFields&&(e.headerFields=e.headerFields.map(e=>e.split(".").map(e=>e.trim()).join(".")));var t,r,e=function(e){const r=Object.keys(s.fieldTitleMap);return e.header=e.headerFields.map(function(e){let t=e;return r.includes(e)?t=s.fieldTitleMap[e]:s.escapeHeaderNestedDots||(t=t.replace(/\\\./g,".")),t}).join(s.delimiter.field),e}(e);return r=(t=e).header,t=e.recordString,(s.excelBOM?b.excelBOM:"")+(s.prependHeader?r+s.delimiter.eol:"")+t}}}}}),v=e({"node_modules/json-2-csv/lib/csv2json.js"(e){"use strict";var i=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,a)}:function(e,t,r,i){e[i=void 0===i?r:i]=t[r]}),a=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return a(t,e),t},c=(Object.defineProperty(e,"__esModule",{value:!0}),e.Csv2Json=void 0,y()),d=m(),f=t(s());e.Csv2Json=function(p){const n=new RegExp(p.delimiter.wrap+p.delimiter.wrap,"g"),t=new RegExp("^"+d.excelBOM),r=p.parseValue&&"function"==typeof p.parseValue?p.parseValue:JSON.parse;function a(e){return e=l(e),p.trimHeaderFields?e.split(".").map(e=>e.trim()).join("."):e}function s(e,t){t=t[e.index],e=function(e){try{var t;return f.isStringRepresentation(e,p)&&!f.isDateRepresentation(e)?e:(t=r(e),Array.isArray(t)?t.map(o):t)}catch(e){return e}}(t);return f.isError(e)||f.isInvalid(e)?"undefined"!==t?t:void 0:e}function o(e){return p.trimFieldValues&&null!==e?e.trim():e}function l(e){var t=e[0],r=e.length-1,i=e[r];return t===p.delimiter.wrap&&i===p.delimiter.wrap?e.length<=2?"":e.substring(1,r):e}function i(a){return a.recordLines.reduce((e,t)=>{t=t.map(e=>{return e=o(e=(e=l(e)).replace(n,p.delimiter.wrap))});r=a.headerFields,i=t;var r,i,t=r.reduce((t,e)=>{var r=s(e,i);try{return(0,c.setPath)(t,e.value,r)}catch(e){return t}},{});return e.concat(t)},[])}return{convert:function(e){return e=e,e=e=function(e){let t=[];if(p.headerFields)t=p.headerFields.map((e,t)=>({value:a(e),index:t}));else{var r=e[0];if(t=r.map((e,t)=>({value:a(e),index:t})),p.keys){const i=p.keys;t=t.filter(e=>i.includes(e.value))}}return{lines:e,headerFields:t,recordLines:[]}}(function(e){var t=[],r=e.length-1,i=p.delimiter.eol.length,a={insideWrapDelimiter:!1,parsingValue:!0,justParsedDoubleQuote:!1,startIndex:0};let n=[],s,o,l,c,d=0;for(;d<e.length;){if(s=e[d],o=d?e[d-1]:"",l=d<r?e[d+1]:"",((c=f.getNCharacters(e,d,i))!==p.delimiter.eol||a.insideWrapDelimiter)&&d!==r||o!==p.delimiter.field)if(d===r&&s===p.delimiter.field){var u=e.substring(a.startIndex,d);n.push(u),n.push(""),t.push(n)}else if(d===r||c===p.delimiter.eol&&(!a.insideWrapDelimiter||o===p.delimiter.wrap&&!a.justParsedDoubleQuote)){u=d!==r||o===p.delimiter.wrap?d:void 0;n.push(e.substring(a.startIndex,u)),t.push(n),n=[],a.startIndex=d+i,a.parsingValue=!0,a.insideWrapDelimiter=l===p.delimiter.wrap}else if(s!==p.delimiter.wrap||o!==p.delimiter.field||a.insideWrapDelimiter||a.parsingValue)if(o===p.delimiter.field&&s===p.delimiter.wrap&&l===p.delimiter.eol)n.push(e.substring(a.startIndex,d-1)),a.startIndex=d,a.parsingValue=!0,a.insideWrapDelimiter=!0,a.justParsedDoubleQuote=!0,d+=1;else if((o!==p.delimiter.wrap||a.justParsedDoubleQuote&&o===p.delimiter.wrap)&&s===p.delimiter.wrap&&f.getNCharacters(e,d+1,i)===p.delimiter.eol)a.insideWrapDelimiter=!1,a.parsingValue=!1;else if(s!==p.delimiter.wrap||0!==d&&(f.getNCharacters(e,d-i,i)!==p.delimiter.eol||a.insideWrapDelimiter))if(s===p.delimiter.wrap&&l===p.delimiter.field&&a.insideWrapDelimiter)n.push(e.substring(a.startIndex,d+1)),a.startIndex=d+2,a.insideWrapDelimiter=!1,a.parsingValue=!1;else if(s===p.delimiter.wrap&&o===p.delimiter.field&&!a.insideWrapDelimiter&&a.parsingValue)n.push(e.substring(a.startIndex,d-1)),a.insideWrapDelimiter=!0,a.parsingValue=!0,a.startIndex=d;else{if(s===p.delimiter.wrap&&l===p.delimiter.wrap&&d!==a.startIndex){d+=2,a.justParsedDoubleQuote=!0;continue}s===p.delimiter.field&&o!==p.delimiter.wrap&&l!==p.delimiter.wrap&&!a.insideWrapDelimiter&&a.parsingValue?(n.push(e.substring(a.startIndex,d)),a.startIndex=d+1):s!==p.delimiter.field||o!==p.delimiter.wrap||l===p.delimiter.wrap||a.parsingValue||(a.insideWrapDelimiter=!1,a.parsingValue=!0,a.startIndex=d+1)}else a.insideWrapDelimiter=!0,a.parsingValue=!0,a.startIndex=d;else a.startIndex=d,a.insideWrapDelimiter=!0,a.parsingValue=!0,f.getNCharacters(e,d+1,i)===p.delimiter.eol&&(d+=p.delimiter.eol.length+1);else c===p.delimiter.eol&&a.startIndex===d||s===p.delimiter.field?n.push(""):n.push(e.substring(a.startIndex)),n.push(""),t.push(n),n=[],a.startIndex=d+i,a.parsingValue=!0,a.insideWrapDelimiter=l===p.delimiter.wrap;d++,a.justParsedDoubleQuote=!1}return t}(p.excelBOM?e.replace(t,""):e)),p.headerFields?e.recordLines=e.lines:e.recordLines=e.lines.splice(1),i(e)}}}}}),e=e({"node_modules/json-2-csv/lib/converter.js"(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.csv2json=e.json2csv=void 0;var r=m(),i=h(),a=v(),n=s();e.json2csv=function(e,t){return t=(0,n.buildJ2COptions)(t??{}),(0,n.validate)(e,n.isObject,r.errors.json2csv),(0,i.Json2Csv)(t).convert(e)},e.csv2json=function(e,t){return t=(0,n.buildC2JOptions)(t??{}),(0,n.validate)(e,n.isString,r.errors.csv2json),(0,a.Csv2Json)(t).convert(e)}}}),w=t(r()),a=t(i()),b=class{constructor(e,t,r={}){this.name=e,this.settingsId=t,this.initialSettingsFields=r,this.settingsFields=this.initialSettingsFields,this.setRerender=null,this.pushSettings=async()=>{for(Object.entries(this.settingsFields).forEach(([e,t])=>{"button"!==t.type&&void 0===this.getFieldValue(e)&&this.setFieldValue(e,t.defaultValue)});!Spicetify?.Platform?.History?.listen;)await new Promise(e=>setTimeout(e,100));this.stopHistoryListener&&this.stopHistoryListener(),this.stopHistoryListener=Spicetify.Platform.History.listen(e=>{"/preferences"===e.pathname&&this.render()}),"/preferences"===Spicetify.Platform.History.location.pathname&&await this.render()},this.rerender=()=>{this.setRerender&&this.setRerender(Math.random())},this.render=async()=>{for(;!document.getElementById("desktop.settings.selectLanguage");){if("/preferences"!==Spicetify.Platform.History.location.pathname)return;await new Promise(e=>setTimeout(e,100))}var e=document.querySelector(".main-view-container__scroll-node-child main div");if(!e)return console.error("[spcr-settings] settings container not found");let t=Array.from(e.children).find(e=>e.id===this.settingsId);t?console.log(t):((t=document.createElement("div")).id=this.settingsId,e.appendChild(t)),a.default.render(w.default.createElement(this.FieldsContainer,null),t)},this.addButton=(e,t,r,i,a)=>{this.settingsFields[e]={type:"button",description:t,value:r,events:{onClick:i,...a}}},this.addInput=(e,t,r,i,a,n)=>{this.settingsFields[e]={type:"input",description:t,defaultValue:r,inputType:a,events:{onChange:i,...n}}},this.addHidden=(e,t)=>{this.settingsFields[e]={type:"hidden",defaultValue:t}},this.addToggle=(e,t,r,i,a)=>{this.settingsFields[e]={type:"toggle",description:t,defaultValue:r,events:{onChange:i,...a}}},this.addDropDown=(e,t,r,i,a,n)=>{this.settingsFields[e]={type:"dropdown",description:t,defaultValue:r[i],options:r,events:{onSelect:a,...n}}},this.getFieldValue=e=>JSON.parse(Spicetify.LocalStorage.get(this.settingsId+"."+e)||"{}")?.value,this.setFieldValue=(e,t)=>{Spicetify.LocalStorage.set(this.settingsId+"."+e,JSON.stringify({value:t}))},this.FieldsContainer=()=>{var[e,t]=(0,w.useState)(0);return this.setRerender=t,w.default.createElement("div",{className:"x-settings-section",key:e},w.default.createElement("h2",{className:"TypeElement-cello-textBase-type"},this.name),Object.entries(this.settingsFields).map(([e,t])=>w.default.createElement(this.Field,{nameId:e,field:t})))},this.Field=r=>{var e=this.settingsId+"."+r.nameId;let t;if(t="button"===r.field.type?r.field.value:this.getFieldValue(r.nameId),"hidden"===r.field.type)return w.default.createElement(w.default.Fragment,null);const[i,a]=(0,w.useState)(t),n=e=>{void 0!==e&&(a(e),this.setFieldValue(r.nameId,e))};return w.default.createElement("div",{className:"x-settings-row"},w.default.createElement("div",{className:"x-settings-firstColumn"},w.default.createElement("label",{className:"TypeElement-viola-textSubdued-type",htmlFor:e},r.field.description||"")),w.default.createElement("div",{className:"x-settings-secondColumn"},"input"===r.field.type?w.default.createElement("input",{className:"x-settings-input",id:e,dir:"ltr",value:i,type:r.field.inputType||"text",...r.field.events,onChange:e=>{n(e.currentTarget.value);var t=r.field.events?.onChange;t&&t(e)}}):"button"===r.field.type?w.default.createElement("span",null,w.default.createElement("button",{id:e,className:"Button-sc-y0gtbx-0 Button-small-buttonSecondary-useBrowserDefaultFocusStyle x-settings-button",...r.field.events,onClick:e=>{n();var t=r.field.events?.onClick;t&&t(e)},type:"button"},i)):"toggle"===r.field.type?w.default.createElement("label",{className:"x-settings-secondColumn x-toggle-wrapper"},w.default.createElement("input",{id:e,className:"x-toggle-input",type:"checkbox",checked:i,...r.field.events,onClick:e=>{n(e.currentTarget.checked);var t=r.field.events?.onClick;t&&t(e)}}),w.default.createElement("span",{className:"x-toggle-indicatorWrapper"},w.default.createElement("span",{className:"x-toggle-indicator"}))):"dropdown"===r.field.type?w.default.createElement("select",{className:"main-dropDown-dropDown",id:e,...r.field.events,onChange:e=>{n(r.field.options[e.currentTarget.selectedIndex]);var t=r.field.events?.onChange;t&&t(e)}},r.field.options.map((e,t)=>w.default.createElement("option",{selected:e===i,value:t+1},e))):w.default.createElement(w.default.Fragment,null)))}}},S=t(e()),O={ru:{artistAndSong:"Скопировать артиста и трек",copied:"Скопировано",copyImage:"Ссылка на изображение",error:"Ошибка",exportList:"Export song list to csv file",settings:{name:"Copy to clipboard settings",separator:"Separator between Song name and Artist names"},songAndArtist:"Скопировать трек и артиста",text:"Скопировать текст"},en:{artistAndSong:"Copy Artist names & Song",copied:"Copied",copyImage:"Copy image link",error:"Error",exportList:"Export song list to csv file",settings:{name:(A={ID:"settings-copy-to-clipboard",NAME:"Copy to clipboard settings",SEPARATOR:{KEY:"ctc-separator",DESCRIPTION:"Separator between Song name and Artist names",DEFAULT:"; "}}).NAME,separator:A.SEPARATOR.DESCRIPTION},songAndArtist:"Copy Song & Artist names",text:"Copy Text"},vi:{artistAndSong:"Sao chép tên nghệ sĩ & bài hát",copied:"Đã sao chép",copyImage:"Sao chép liên kết ảnh",error:"Lỗi",exportList:"Xuất danh sách bài hát ra file csv",settings:{name:"Cài đặt Copy to clipboard",separator:"Phân cách giữa tên bài hát và tên nghệ sĩ"},songAndArtist:"Sao chép tên bài hát & nghệ sĩ",text:"Sao chép tên"}},I=async function(){for(;!Spicetify||"complete"!==document.readyState;)await new Promise(e=>setTimeout(e,1e3));await new Promise(e=>setTimeout(e,1e3)),e=Spicetify.Locale?Spicetify.Locale.getLocale():"en";var e=await(Object.keys(O).includes(e)?O[e]:O.en),t=new b(e.settings.name,A.ID);t.addInput(A.SEPARATOR.KEY,e.settings.separator,A.SEPARATOR.DEFAULT),t.pushSettings(),k(e)},(async()=>{await I()})();async function j(e,t){try{var r=await Spicetify.CosmosAsync.get("https://api.spotify.com/v1/albums/"+t);return"image"===e?r.images[0].url:r.name}catch(e){throw console.log(e),new Error(e.message)}}async function x(e,t){var r=Spicetify.GraphQL.Definitions["queryArtistOverview"];try{var i=Spicetify.Locale?Spicetify.Locale.getLocale():"en",a=(await Spicetify.GraphQL.Request(r,{uri:t,includePrerelease:!1,locale:i,offset:0,limit:10}))["data"];if("image"!==e)return a.artistUnion.profile.name;var n=a.artistUnion.headerImage?.data?.sources?.[0]?.url;if(n)return n;throw new Error("No images")}catch(e){throw console.log(e),new Error(e.message)}}async function E(e){var t=Spicetify.GraphQL.Definitions["getTrackName"];try{var r=(await Spicetify.GraphQL.Request(t,{uri:e,offset:0,limit:10}))["data"];return r.trackUnion.name}catch(e){throw console.log(e),new Error(e.message)}}function C(e){if(e.includes("mosaic:"))throw new Error("Cannot copy mosaic image");if(e.startsWith("spotify")){var t=e.split(":").pop();if(t)return"https://i.scdn.co/image/"+t;throw new Error("Not found")}return e}async function P(e,t){try{var r=await Spicetify.CosmosAsync.get("sp://core-playlist/v1/playlist/spotify:playlist:"+t);return"name"===e?r.playlist.name:C(r.playlist.picture)}catch(e){throw console.log(e),new Error(e.message)}}async function L(e,t){try{var r=await Spicetify.CosmosAsync.get(`sp://core-show/v1/shows/${t}?responseFormat=protobufJson`);return"name"===e?r.header.showMetadata.name:C(r.header.showMetadata.covers.xlargeLink)}catch(e){throw console.log(e),new Error(e.message)}}async function R(e,t){try{var r=await Spicetify.Platform.ShowAPI.getEpisodeOrChapter("spotify:episode:"+t);return"name"===e?r.name:C(r.coverArt.reduce((e,t)=>e.width>t.width?e:t,{width:0,height:0,url:""}).url)}catch(e){throw console.log(e),new Error(e.message)}}async function N(e,t){try{var r=await Spicetify.CosmosAsync.get("sp://core-profile/v1/profiles",{usernames:t});return"name"===e?r.profiles[0].name:r.profiles[0].images.reduce((e,t)=>e.maxWidth>t.maxWidth?e:t,{maxWidth:0,maxHeight:0,url:""}).url}catch(e){throw console.log(e),new Error(e.message)}}async function D(e){var[e,t]=await Promise.allSettled([E(e),async function(e){var t=Spicetify.GraphQL.Definitions["queryTrackArtists"];try{var r=(await Spicetify.GraphQL.Request(t,{uri:e,offset:0,limit:10}))["data"];return r.trackUnion.artists.items.map(e=>e.profile.name).join(", ")}catch(e){throw console.log(e),new Error(e.message)}}(e)]),r=new b(A.NAME,A.ID).getFieldValue(A.SEPARATOR.KEY);return"fulfilled"===e.status&&"fulfilled"===t.status?{texts:[e.value,t.value],separator:r}:{texts:[],separator:r}}function _(e){return e.replace(/[/\\?%*:|"<>]/g,"-").trim()}async function F({data:e,suggestedName:t}){e=new Blob([e],{type:"text/csv"});try{var r=await(await window.showSaveFilePicker({suggestedName:t,types:[{accept:{"text/csv":[".csv"]}}]})).createWritable();await r.write(e),await r.close()}catch(e){if(e instanceof Error&&"AbortError"!==e.name)throw console.error(e.name,e.message),e}}async function T(e){try{var t=Spicetify.GraphQL.Definitions["getAlbum"],{albumUnion:r}=(await Spicetify.GraphQL.Request(t,{uri:e,includePrerelease:!1,locale:"",offset:0,limit:50}))["data"],{tracksV2:{items:i},name:a,artists:{items:n}}=r;const s=[];return i.forEach(e=>{var{discNumber:e,artists:t,name:r,trackNumber:i}=e["track"];s.push({discNumber:e,trackNumber:i,name:r,artists:t.items.map(e=>e.profile.name).join("; ")})}),{data:s,filename:a+" by "+n.map(e=>e.profile.name).join(", ")}}catch(e){throw console.log(e),new Error(e.message)}}function k(h){function n(e){e&&(Spicetify.showNotification(h.copied+": "+e),Spicetify.Platform.ClipboardAPI.copy(e))}var e=e=>{var t;return 1===e.length&&(t=Spicetify.URI["Type"],Spicetify.URI.fromString(e[0]).type===t.TRACK)};new Spicetify.ContextMenu.Item(h.text,async e=>{var t=Spicetify.URI["Type"],r=Spicetify.URI.fromString(e[0]);const i=r._base62Id||r.id;try{switch(r.type){case t.TRACK:n(await E(r.toURI()));break;case t.LOCAL:var a=[];r.track&&a.push(r.track),r.artist&&a.push(r.artist),r.album&&a.push(r.album),n(a.join("; "));break;case t.LOCAL_ARTIST:n(""+(r.artist||""));break;case t.LOCAL_ALBUM:n(""+(r.album||""));break;case t.ALBUM:n(await j("name",r.id));break;case t.ARTIST:n(await x("name",r.toURI()));break;case t.PLAYLIST:case t.PLAYLIST_V2:n(await P("name",i));break;case t.SHOW:n(await L("name",i));break;case t.EPISODE:n(await R("name",i));break;case t.PROFILE:n(await N("name",r.username));break;case t.FOLDER:n((await Spicetify.Platform.RootlistAPI.getContents()).items.filter(e=>"folder"===e.type&&e.uri.includes(i))[0].name)}}catch(e){Spicetify.showNotification(h.error+": "+e.message)}},e=>{if(1!==e.length)return!1;var t=Spicetify.URI["Type"];switch(Spicetify.URI.fromString(e[0]).type){case t.TRACK:case t.LOCAL:case t.LOCAL_ARTIST:case t.LOCAL_ALBUM:case t.ALBUM:case t.ARTIST:case t.PLAYLIST:case t.PLAYLIST_V2:case t.SHOW:case t.EPISODE:case t.PROFILE:case t.FOLDER:return!0;default:return!1}},"copy").register(),new Spicetify.ContextMenu.Item(h.songAndArtist,async e=>{var t,r,i=Spicetify.URI["Type"],e=Spicetify.URI.fromString(e[0]);try{e.type===i.TRACK&&({separator:t,texts:r}=await D(e.toURI()),0<r.length)&&n(r[0]+t+r[1])}catch(e){Spicetify.showNotification(h.error+": "+e.message)}},e,"artist").register(),new Spicetify.ContextMenu.Item(h.artistAndSong,async e=>{var t,r,i=Spicetify.URI["Type"],e=Spicetify.URI.fromString(e[0]);try{e.type===i.TRACK&&({separator:t,texts:r}=await D(e.toURI()),0<r.length)&&n(r[1]+t+r[0])}catch(e){Spicetify.showNotification(h.error+": "+e.message)}},e,"artist").register(),new Spicetify.ContextMenu.Item(h.exportList,async e=>{var t,r,i=Spicetify.URI["Type"],a=Spicetify.URI.fromString(e[0]);try{switch(a.type){case i.ALBUM:t=a.toURI(),r=_((t=await T(t)).filename)+".csv",await F({data:(0,S.json2csv)(t.data,{excelBOM:!0}),suggestedName:r});break;case i.ARTIST:{var n=a.toURI();var s=await x("name",n),o=Spicetify.GraphQL.Definitions["queryArtistDiscographyAll"];const y=[];let e=0;for(;;){var{items:l}=(await Spicetify.GraphQL.Request(o,{uri:n,order:"DATE_DESC",offset:e,limit:50}))["data"]["artistUnion"]["discography"]["all"];if(l.forEach(e=>{e.releases.items.forEach(e=>{y.push({name:e.name,releaseDate:e.date.isoString,type:e.type,uri:e.uri})})}),l.length<50)break;e=y.length}var c=y.map(async t=>{return(await T(t.uri)).data.map(e=>({albumName:t.name,discNumber:e.discNumber,trackNumber:e.trackNumber,name:e.name,artists:e.artists,type:t.type,releaseDate:t.releaseDate}))}),c=await Promise.allSettled(c);const g=[];c.forEach(e=>{"fulfilled"===e.status&&e.value.forEach(e=>{g.push(e)})}),await F({data:(0,S.json2csv)(g,{excelBOM:!0}),suggestedName:_(s)+".csv"})}await 0;break;case i.PLAYLIST:Spicetify.showNotification(h.error+": Unsupported right now. Please file a issue with this playlist");break;case i.PLAYLIST_V2:var d=a._base62Id||a.id;try{var{items:u,playlist:{name:p,owner:f}}=await Spicetify.CosmosAsync.get("sp://core-playlist/v1/playlist/spotify:playlist:"+d),m=u.map(e=>({name:e.name,artists:e.artists.map(e=>e.name).join("; "),albumName:e.album.name}));await F({data:(0,S.json2csv)(m,{excelBOM:!0}),suggestedName:_(p+", "+f.name)+".csv"})}catch(e){throw console.log(e),new Error(e.message)}await 0}}catch(e){Spicetify.showNotification(h.error+": "+e.message)}},e=>{if(1===e.length){var t=Spicetify.URI["Type"];switch(Spicetify.URI.fromString(e[0]).type){case t.ALBUM:case t.ARTIST:case t.PLAYLIST:case t.PLAYLIST_V2:return!0;default:return!1}}return!1},"list-view").register(),new Spicetify.ContextMenu.Item(h.copyImage,async e=>{var t=Spicetify.URI["Type"],r=Spicetify.URI.fromString(e[0]),i=r._base62Id||r.id;try{switch(r.type){case t.TRACK:n(await E(r.toURI()));break;case t.ALBUM:n(await j("image",r.id));break;case t.ARTIST:n(await x("image",r.toURI()));break;case t.PLAYLIST:case t.PLAYLIST_V2:n(await P("image",i));break;case t.SHOW:n(await L("image",i));break;case t.EPISODE:n(await R("image",i));break;case t.PROFILE:n(await N("image",r.username))}}catch(e){Spicetify.showNotification(h.error+": "+e.message)}},e=>{if(1===e.length){var t=Spicetify.URI["Type"];switch(Spicetify.URI.fromString(e[0]).type){case t.ALBUM:case t.ARTIST:case t.PLAYLIST:case t.PLAYLIST_V2:case t.SHOW:case t.EPISODE:case t.PROFILE:return!0;default:return!1}}return!1},"copy").register()}}();